from moviepy.editor import ImageSequenceClip
import os
import requests
import unicodedata
import shutil
from PIL import Image
from groq import Groq

#Api key
GROQ_API_KEY = os.getenv('API_Qroq')

# Cliente de Groq
client = Groq(api_key=GROQ_API_KEY)

imgLenguaje = r"C:\Users\josue\OneDrive - Universidad Tecnologica del Peru\Desktop\Includify2.0\flaskAPI\imgLenguaje"
video_path = os.path.join(r"C:\Users\josue\OneDrive - Universidad Tecnologica del Peru\Desktop\Includify2.0\flaskAPI", "Señas.mp4")

os.makedirs(imgLenguaje, exist_ok=True)

list_words = ['abajo', 'babosa', 'caballero', 'dañado', 'ebullición', 'Facatativa', 'gabinete', 'habichuela', 'Ibague', 'jabalina', 'kilogramo', 'm', 'nacer', 'obedecer', 'paciencia', 'q', 'rabia', 'sábado', 'Ubate', 'vaca', 'web', 'xilema', 'ya', 'zanahoria', 'abandonar', 'bafle', 'caballo', 'danza', 'eclipse', 'facebook', 'Gachetá', 'habitad', 'ICAP', 'jabón', 'kilolitro', 'Mac', 'nacimiento', 'padre', 'qué', 'racionalizada', 'sabana', 'tablero', 'último', 'vacaciones', 'Whatsapp', 'Yacuanquer', 'zancudo', 'abanico', 'bailar', 'cabello', 'dar', 'Ecopetrol', 'fácil', 'gafas', 'ICBF', 'jaguar', 'kilómetro', 'machismo', 'nacionalismo', 'objetivo', 'radiación', 'tacaño', 'un', 'vacuna', 'wifi', 'yarda', 'Zipaquirá', 'abarcar', 'bailarina', 'cabeza', 'ecosistema', 'Galán', 'hablar', 'ICFES', 'jamás', 'macho', 'nacionalista', 'padres', 'radicación', 'saber', 'tacones', 'vagina', 'abofetear', 'bajar', 'cabra', 'de', 'ecuaciones', 'factores', 'Gálapa', 'idea', 'Jamundí', 'madre', 'nada', 'padrino', 'radical', 'sabiduría', 'tacto', 'vaivén', 'abonar', 'Cabrera', 'Gálatas', 'identidad', 'jardín', 'Madrid', 'nadan', 'pagar', 'quedar', 'radio', 'sabroso', 'valioso', 'abono', 'bajo', 'cachucha', 'factorización', 'galleta', 'idioma', 'jardinero', 'madrina', 'nadar', 'obligación', 'Paila', 'quemadura', 'radiografía', 'sacerdote', 'Taironas', 'uña', 'valle', 'aborto', 'balanceo', 'Falán', 'gallina', 'iglesia', 'jaula', 'madrugada', 'naipe', 'observar', 'Pailitas', 'querer', 'radiolarios', 'saco', 'ungir', 'Abraham', 'balanza', 'cadena', 'edificio', 'falda', 'gallo', 'hacer', 'jefe', 'madrugar', 'naranja', 'obstreta', 'Paipa', 'queso', 'raiz', 'sacramento', 'talco', 'unicelular', 'abreviar', 'Balboa', 'caer', 'deber', 'editorial', 'falla', 'galón', 'igual', 'narigón', 'paisaje', 'rango', 'tallo', 'unidad', 'valores', 'abrigo', 'ballena', 'café', 'deberes', 'fallar', 'Gamarra', 'hacienda', 'igualdad', 'Magangué', 'nariguera', 'Ocamote', 'pájaro', 'sacrificar', 'tamal', 'uniforme', 'vamos', 'abril', 'ballet', 'Caicedonia', 'débil', 'EEUU', 'False', 'Gambita', 'hamaca', 'ilustración', 'jeringa', 'Magdalena', 'Nariño', 'Ocaña', 'palabra', 'quién', 'rápido', 'sacrificio', 'Tamalameque', 'vanidad', 'baloncesto', 'caja', 'década', 'Efesios', 'falta', 'ganancias', 'hambre', 'Jerusalén', 'magia', 'nariz', 'ochenta', 'quiero', 'raro', 'sadismo', 'también', 'vara', 'absorber', 'banano', 'decágono', 'eficaz', 'familia', 'gancho', 'hay', 'imaginación', 'magisterio', 'natación', 'ocho', 'Quimbaya', 'ratón', 'tampoco', 'Universidad', 'vaso', 'abstracto', 'bañar', 'Cajamarca', 'decagramo', 'eficiente', 'famoso', 'hebreo', 'imán', 'Jordán', 'magnetismo', 'natural', 'ochocientos', 'quince', 'rayo', 'Sahagún', 'tangente', 'uno', 'veedor', 'abuelo', 'Banco', 'cajón', 'decalitro', 'egoista', 'fanático', 'hectarea', 'imitar', 'ladeado', 'naturaleza', 'oclusivo', 'quincena', 'sal', 'Tángua', 'urgente', 'veinte', 'aburrido', 'bandera', 'cal', 'decámetro', 'el', 'fanegada', 'garaje', 'hectógramo', 'impenetrabilidad', 'Josué', 'ladear', 'Mahates', 'navidad', 'octágono', 'Quindío', 'razón', 'sala', 'tarde', 'Uribe', 'vela', 'abuso', 'banquete', 'calamar', 'fantasía', 'garrote', 'hectolitro', 'implicación', 'joven', 'ladrar', 'Mahoma', 'Nazareth', 'octubre', 'quinientos', 'tardes', 'urólogo', 'velatorio', 'banquitas', 'calambre', 'decena', 'faringe', 'gas', 'hectómetro', 'imponer', 'ladrillo', 'Maicáo', 'nazismo', 'ocupado', 'recepción', 'tarea', 'Urráo', 'velludo', 'acabar', 'barato', 'Calarcá', 'decente', 'fariseos', 'gaseosa', 'importación', 'joyero', 'lágrima', 'mal', 'néctar', 'odio', 'quinto', 'recordar', 'té', 'Uruguay', 'Venadillo', 'acariciar', 'barbero', 'calcio', 'decepcionado', 'faro', 'gasolina', 'heptágono', 'importante', 'lagrimeo', 'negro', 'oferta', 'quiste', 'rectángulo', 'usb', 'venado', 'Barbosa', 'calcular', 'decígramo', 'fascinar', 'gato', 'herbívoros', 'imposible', 'juanete', 'laico', 'Málaga', 'Neira', 'oficina', 'recto', 'usted', 'aceite', 'Barrabás', 'decilitro', 'fauna', 'gelatina', 'herejía', 'jubilación', 'lana', 'Malambo', 'neolítico', 'ofrecer', 'rector', 'salado', 'ustedes', 'vendedor', 'acelerar', 'Barrancabermeja', 'Caldas', 'decímetro', 'fe', 'gen', 'hermano', 'imprevisto', 'lapicero', 'maleabilidad', 'nervio', 'ofrenda', 'palanca', 'Salamina', 'vender', 'acento', 'Barranquilla', 'Caldereta', 'febrero', 'generoso', 'Herodes', 'incapacitado', 'judío', 'lapiz', 'malo', 'nervioso', 'oftalmólogo', 'paleolítico', 'Salazar', 'útero', 'Venecia', 'aceptar', 'barrer', 'caldo', 'decir', 'fecha', 'Génesis', 'herpes', 'Incas', 'jueves', 'mamá', 'neurona', 'Oiba', 'Palestina', 'salchicha', 'técnico', 'Útica', 'veneno', 'acera', 'base', 'Cali', 'decisión', 'fecundación', 'genotipo', 'herramientas', 'INCI', 'jugar', 'Mamatoco', 'oído', 'pálido', 'salchichón', 'tecnología', 'uva', 'venir', 'acercar', 'basura', 'caliente', 'dedicación', 'federación', 'Genova', 'HETAH', 'incisivos', 'láser', 'mamíferos', 'oidores', 'Salento', 'tecnológicas', 'ventana', 'acercarse', 'bautizado', 'Califa', 'dedos', 'felicitaciones', 'gente', 'hexágono', 'inclusión', 'látigo', 'mamografía', 'neutro', 'oír', 'salida', 'tejido', 'Ventures', 'ácido', 'bautizar', 'calificación', 'elasticidad', 'felicitar', 'gentilicio', 'hiato', 'incógnita', 'juicioso', 'latín', 'mañana', 'neutrón', 'ojalá', 'Palmira', 'redondeo', 'salmo', 'ver', 'bautizo', 'calificar', 'dejar', 'elástico', 'geología', 'hiena', 'incoloro', 'julio', 'mandarina', 'nevera', 'ojeras', 'paludismo', 'reflexión', 'verbo', 'aclaración', 'bazo', 'caliz', 'eléctrica', 'feliz', 'geometría', 'hígado', 'incorporar', 'junio', 'Latinoamérica', 'manejar', 'Nicaragua', 'ojos', 'pan', 'reforestación', 'saltan', 'verdad', 'acné', 'bebé', 'calle', 'delegar', 'electricista', 'gerundio', 'higiene', 'incubación', 'latitud', 'nieto', 'olfato', 'panadero', 'refrán', 'saltar', 'verde', 'acólitos', 'Becerríl', 'calórica', 'delgado', 'electrón', 'feo', 'gimnacio', 'hijo', 'incubadora', 'justicia', 'lavadero', 'mango', 'niño', 'olimpiada', 'pañal', 'refuerzo', 'salud', 'verdura', 'acomodar', 'becerro', 'calvo', 'delicadeza', 'elefante', 'feria', 'gimnasia', 'hilum', 'incumplir', 'justificar', 'leal', 'manifestación', 'nivel', 'olor', 'panela', 'regañar', 'saludo', 'Versalles', 'acompañar', 'Belalcazar', 'calzones', 'demorar', 'elegante', 'fértil', 'ginecólogo', 'himen', 'indicativo', 'lealtad', 'no', 'olvidar', 'pantalón', 'régimen', 'Salvador', 'verso', 'acosar', 'Belén', 'denominador', 'elegir', 'festivo', 'Girardot', 'índice', 'Lebrija', 'manipular', 'omnívoros', 'pantaloncillo', 'tela', 'vertebrados', 'densidad', 'elemento', 'Girardota', 'hiperactivo', 'indocumentado', 'lección', 'maniquí', 'once', 'pantufla', 'regla', 'salvaje', 'teléfono', 'acostarse', 'cámara', 'dentadura', 'ella', 'fidelidad', 'glande', 'hipérbole', 'inexacta', 'leccionario', 'Manizales', 'papá', 'Samaníego', 'vestido', 'acta', 'dentario', 'ellas', 'fiebre', 'glándulas', 'hipismo', 'infarto', 'mano', 'operacionales', 'Pápa', 'Samsung', 'telégrafo', 'actitud', 'belice', 'camarón', 'deportar', 'ellos', 'figura', 'hipoacúsico', 'infinitivo', 'lechuga', 'Manta', 'operador', 'papaya', 'Samuel', 'telescopio', 'actual', 'bendición', 'camarones', 'deporte', 'hipocáusico', 'inflamable', 'lector', 'mantel', 'opinar', 'papel', 'regocijar', 'televisión', 'vestir', 'acuario', 'benegnidad', 'cambiar', 'depredación', 'embalses', 'filtración', 'hipotenusa', 'información', 'leer', 'manzana', 'optimista', 'reinado', 'televisor', 'vestirse', 'acuático', 'Betulia', 'camello', 'deprimido', 'embarazo', 'hippie', 'ingeniero', 'Manzanares', 'oración', 'papilas', 'reinar', 'telofase', 'acunar', 'Biblia', 'camilla', 'derechos', 'embetunar', 'finca', 'histerectomía', 'Maparipán', 'para', 'reine', 'temblor', 'vicepresidente', 'acurrucar', 'bibliografía', 'caminan', 'derivada', 'emblema', 'historia', 'inhalar', 'Lejanías', 'maquillarse', 'noches', 'reir', 'vicio', 'Adán', 'biblioteca', 'caminar', 'dermis', 'embobar', 'fino', 'glóbulos', 'historieta', 'inicio', 'lejos', 'noción', 'témpera', 'Victoria', 'adaptación', 'bibliotecólogo', 'camisa', 'derrotar', 'embolador', 'firma', 'gloriosos', 'hogar', 'inmenso', 'lengua', 'nombre', 'paradero', 'temperatura', 'vida', 'adelantar', 'bien', 'camiseta', 'desacuerdo', 'embrión', 'firmar', 'google', 'hojas', 'inmiscuir', 'nonágono', 'paramecio', 'templanza', 'viejo', 'adherir', 'bienvenido', 'campana', 'desafío', 'embudo', 'firme', 'gordo', 'hola', 'innovadora', 'lenguaje', 'maravilloso', 'nosotros', 'páramo', 'temprano', 'viernes', 'adhesión', 'bigote', 'campeón', 'desarrollar', 'emigración', 'fiscal', 'gorila', 'hombre', 'innovadores', 'marcador', 'órbita', 'tenemos', 'Villamaría', 'adhesivo', 'bilingüismo', 'campeonato', 'desayuno', 'emocionado', 'flaco', 'hombro', 'mareo', 'noticia', 'Parausía', 'tener', 'Villavicencio', 'adiestrar', 'bilirrubina', 'descansa', 'empalme', 'Flandes', 'gracia', 'homenaje', 'inoloro', 'lentes', 'margarita', 'noticiero', 'orden', 'relaciones', 'tengo', 'Villeta', 'adios', 'bilis', 'cana', 'descansar', 'empanada', 'flecha', 'gracias', 'homosexual', 'inquisición', 'María', 'novecientos', 'parecido', 'relajación', 'tenis', 'vino', 'adiposa', 'billete', 'Canadá', 'descomposición', 'emparedado', 'flexión', 'hondo', 'insaboro', 'leopardo', 'novela', 'ordenar', 'parénquima', 'sanación', 'Tenjo', 'violación', 'adjetivo', 'canasta', 'descripción', 'empate', 'flojo', 'grados', 'honestidad', 'inscripción', 'leproso', 'marioneta', 'noventa', 'oreja', 'religión', 'Sandoná', 'tensión', 'Viotá', 'billetera', 'cáncer', 'descubrir', 'empezar', 'Florencia', 'grafema', 'honrado', 'insecticida', 'Lérida', 'Marquetalia', 'noviembre', 'órganos', 'religiosa', 'sangre', 'tentación', 'virgen', 'billones', 'Canciller', 'desea', 'florero', 'gráfica', 'hora', 'insectívoros', 'Marsella', 'novio', 'relog', 'sano', 'teorema', 'virus', 'adjuntar', 'bimestral', 'candado', 'desgastar', 'empleo', 'flota', 'hospital', 'insectos', 'letra', 'martes', 'núcleo', 'orgulloso', 'paréntesis', 'reloj', 'visa', 'binomio', 'candelabro', 'deshidratación', 'Emprendetic', 'fluctuación', 'hostia', 'inseminación', 'Marulanda', 'nudo', 'origen', 'renovables', 'visitar', 'admirar', 'bioética', 'Candelaria', 'desigual', 'enamorar', 'fonema', 'hotel', 'insolación', 'marzo', 'nuera', 'ortodoncista', 'parónimas', 'renuncia', 'terapia', 'admitir', 'biología', 'candelero', 'desinfectar', 'encantar', 'forma', 'gramática', 'hoy', 'INSOR', 'levantarse', 'mas', 'nuestro', 'ortografía', 'parpadeo', 'repasar', 'Santiago', 'tercero', 'visual', 'adobar', 'biopsia', 'candidato', 'deslizar', 'encarnación', 'formal', 'Granada', 'inspiración', 'lexema', 'masa', 'nueve', 'oscilación', 'párpados', 'repetir', 'santificador', 'terco', 'vivíparos', 'adopción', 'biósfera', 'caneca', 'desmayarse', 'encéfalo', 'formar', 'granadilla', 'Huila', 'instinto', 'léxico', 'masaje', 'nuevo', 'oscuro', 'parque', 'reposo', 'terminal', 'vocabulario', 'adoptar', 'bipartición', 'cangrejo', 'desnudar', 'encendedor', 'grande', 'humanidad', 'Líbano', 'ósea', 'párrafo', 'represa', 'sapo', 'terminar', 'vocal', 'adorable', 'bípedos', 'canguro', 'desobediente', 'encestador', 'foro', 'granívoros', 'humanitaria', 'liberación', 'matas', 'Oséas', 'parrilla', 'representante', 'termómetro', 'voltimetro', 'adoración', 'bisílaba', 'canino', 'desodorante', 'encestar', 'fortaleza', 'grano', 'humano', 'insulto', 'libertad', 'matemáticas', 'numerador', 'oso', 'reproducción', 'terremoto', 'volumen', 'adorar', 'bisturí', 'canoso', 'desordenar', 'enciclopedismo', 'forzar', 'grasa', 'humilde', 'inteligencia', 'libra', 'materia', 'número', 'ostra', 'participar', 'reproductora', 'terrestre', 'vuelan', 'adormilar', 'bizco', 'cansado', 'despertar', 'Encino', 'grasoso', 'humus', 'inteligente', 'líder', 'matrimonio', 'otorrinolaringólogo', 'participio', 'reptan', 'Tesalonicenses', 'vulva', 'adulto', 'blanco', 'cantar', 'después', 'encoger', 'fotocopiadora', 'gratis', 'intención', 'limón', 'reptiles', 'secante', 'tesorero', 'adverbio', 'blanqueador', 'cantidad', 'desvestirse', 'encontrar', 'fotosíntesis', 'grave', 'interacción', 'limosnero', 'Mayas', 'números', 'otro', 'república', 'secretaria', 'tesoro', 'advertir', 'blasfemia', 'desvincularse', 'fracasado', 'gravedad', 'interdependencia', 'limpiar', 'mayo', 'ovario', 'secreto', 'testículos', 'aéreos', 'blusa', 'capilar', 'deterioro', 'enemigo', 'greca', 'interés', 'limpio', 'mayonesa', 'ovíparos', 'residir', 'secretora', 'testigo', 'afán', 'bobada', 'capital', 'determinante', 'energía', 'fractura', 'griego', 'lindísimo', 'mayor', 'ovispo', 'pasado', 'residuo', 'sed', 'afiche', 'boca', 'Capitanejo', 'Deuteronomio', 'frágil', 'grieta', 'lindo', 'mazamorra', 'ovulación', 'resorte', 'sedimentación', 'afiliado', 'bocadillo', 'capitulo', 'día', 'enero', 'fraile', 'grillo', 'interferir', 'mazorca', 'óvulos', 'pasaporte', 'respetar', 'seguir', 'Tibú', 'afrontar', 'bodega', 'cara', 'diácono', 'enfermedad', 'frasco', 'gripa', 'linfático', 'mecer', 'oxidación', 'páscua', 'tiburón', 'agachar', 'bofetada', 'caracol', 'diagonal', 'enfermo', 'frase', 'grís', 'lingüista', 'medalla', 'oxígeno', 'pasta', 'segundo', 'agarrar', 'Bogotá', 'carácter', 'dialecto', 'enflaquecer', 'frecuencia', 'grito', 'lisosomas', 'Medellín', 'oyente', 'pastilla', 'respirar', 'seguro', 'tienda', 'agentes', 'Bojacá', 'Carcasí', 'dialogar', 'enfrentar', 'freno', 'grosero', 'internado', 'lista', 'media', 'Pasto', 'responsabilidad', 'seis', 'agosto', 'boleta', 'cardiólogo', 'diámetro', 'enfrente', 'frente', 'Guaca', 'internar', 'litro', 'nunca', 'patacón', 'responsable', 'tigre', 'agotado', 'Bolivar', 'carga', 'diarrea', 'enganchar', 'fresa', 'Guacarí', 'internet', 'mediatriz', 'nutrientes', 'patagonia', 'respuesta', 'seiscientos', 'tijera', 'agotar', 'cargo', 'días', 'enlace', 'Fresno', 'Guadalupe', 'interno', 'llamado', 'medicamento', 'pataleta', 'resta', 'semana', 'timbre', 'agregar', 'caribe', 'diástole', 'ensalada', 'frío', 'Guamal', 'interponer', 'llámame', 'patena', 'restaurante', 'timo', 'agua', 'caridad', 'dibujar', 'enseñame', 'frontera', 'guantes', 'interpretar', 'llamar', 'médico', 'pato', 'Restrepo', 'semestral', 'Timotéo', 'bolsa', 'Dibulla', 'enseñar', 'Frontino', 'guapo', 'interprete', 'paz', 'resurección', 'seminario', 'tinto', 'bolso', 'carne', 'diciembre', 'ensordecido', 'frustado', 'Guapota', 'interrumpir', 'SENA', 'tío', 'aguacate', 'bomba', 'carnicero', 'dicípulo', 'entender', 'fruta', 'Guarne', 'intersección', 'llamas', 'pecado', 'señas', 'Tito', 'aguacero', 'caro', 'dictado', 'entendimiento', 'Guática', 'llamativo', 'pedagógica', 'retina', 'seno', 'tiza', 'Aguadas', 'bombardear', 'carpeta', 'didáctico', 'entrar', 'Guavata', 'llano', 'pedazo', 'Retiro', 'senos', 'toalla', 'bondad', 'carrera', 'diecinueve', 'fuerte', 'guayaba', 'introducción', 'llanto', 'Pedro', 'reto', 'sentido', 'bonita', 'carreras', 'dieciocho', 'entrecruzamiento', 'funciones', 'gusano', 'inundación', 'llanura', 'pegante', 'retraso', 'sentidos', 'toca', 'ahora', 'borrador', 'carro', 'dieciseis', 'Entrerios', 'funda', 'gusanos', 'inutil', 'llave', 'reunión', 'sentir', 'tocador', 'ají', 'Bosconia', 'carta', 'diecisiete', 'Envigado', 'Fundación', 'gustar', 'invadir', 'llegar', 'reunir', 'separado', 'Tocaima', 'ajo', 'botas', 'Cartagena', 'dientes', 'epidermis', 'fundador', 'inventar', 'llenar', 'mejor', 'revolución', 'septiembre', 'tocar', 'ajustar', 'botella', 'diéresis', 'epiglotis', 'Funes', 'invento', 'llevar', 'Melgar', 'peinilla', 'rey', 'ser', 'botiquín', 'cartelera', 'diez', 'epitelial', 'Funza', 'inversión', 'llorar', 'membrana', 'pelear', 'RH', 'seres', 'cartilaginoso', 'diferente', 'epitelio', 'furioso', 'inverso', 'llover', 'memoria', 'peligroso', 'Ricaurte', 'todopoderoso', 'ala', 'cartuchera', 'difícil', 'equilibrio', 'fusible', 'invertebrados', 'llovizna', 'menos', 'pelo', 'rico', 'todos', 'alabanza', 'bránquias', 'casa', 'difusión', 'equinodermos', 'fusiforme', 'investidura', 'lluvia', 'menstruación', 'pelota', 'riesgo', 'serio', 'Alba', 'brassier', 'digestivo', 'equipaje', 'fusión', 'invidente', 'mensual', 'peluquería', 'rinoceronte', 'servidumbre', 'Toledo', 'Albania', 'bravo', 'dígito', 'equipo', 'futbol', 'invitame', 'mentir', 'riñones', 'sesenta', 'tolerancia', 'Alcalá', 'brazo', 'casado', 'dignidad', 'equivalente', 'futuro', 'invitar', 'mentiroso', 'penar', 'setarse', 'Tolima', 'Alcalde', 'brillante', 'cáscara', 'dilatación', 'equivocar', 'involuntario', 'lobo', 'mentón', 'péndulo', 'setecientos', 'tomar', 'Alcaldía', 'bromear', 'casi', 'dimensiones', 'era', 'inyección', 'localizar', 'mercado', 'pene', 'Riohacha', 'setenta', 'alcanzar', 'bronquiolos', 'cassette', 'diminutivo', 'ipad', 'logaritmo', 'mercancía', 'penitencia', 'Ríosucio', 'seudónimo', 'Tomás', 'brónquios', 'dinero', 'Iphone', 'lógica', 'mes', 'Peñol', 'riquísimo', 'sexólogo', 'tomate', 'brujo', 'Casulla', 'Dios', 'Iris', 'longitud', 'pensar', 'si', 'brújula', 'catecúmeno', 'erizado', 'irradiar', 'Mesetas', 'Sibaté', 'alcoba', 'Bucaramanga', 'catetos', 'director', 'esbelta', 'irrumpir', 'mesías', 'robar', 'sicolingüista', 'torneo', 'alcoholismo', 'bucear', 'católico', 'escamas', 'Isaías', 'mesoamerica', 'Pensilvania', 'robusto', 'sida', 'toro', 'alerta', 'catorce', 'discapacidad', 'escoger', 'Islam', 'meta', 'pentágono', 'siempre', 'torta', 'aletas', 'caucho', 'discoteca', 'escogida', 'isquión', 'lotero', 'rojo', 'siete', 'tortuga', 'alfabeto', 'causa', 'discreción', 'escolástica', 'Israel', 'luminosos', 'metafase', 'peor', 'Romanos', 'siglo', 'tos', 'buenas', 'discurso', 'esconder', 'metamorfosis', 'pequeñito', 'rombo', 'significante', 'álgebra', 'bueno', 'cebolla', 'diseñador', 'lunes', 'metido', 'pequeño', 'romper', 'signo', 'trabajar', 'algodón', 'buenos', 'luruaco', 'método', 'pera', 'roncar', 'sílaba', 'traer', 'algunos', 'bulbo', 'ceja', 'diseño', 'lustrabotas', 'perder', 'ropa', 'silencio', 'tragedia', 'alimentador', 'celador', 'disgregación', 'escribir', 'lustrar', 'rosa', 'silogismo', 'tranquilo', 'bulto', 'celebrar', 'dispersar', 'escritor', 'lustro', 'perdón', 'rosado', 'simpático', 'transmilenio', 'alisar', 'buñuelo', 'celentéreos', 'distanciarse', 'escuadra', 'luto', 'México', 'pereza', 'rosario', 'simple', 'transparente', 'aliviar', 'burgos', 'celoma', 'disyunto', 'escucha', 'luz', 'mezcla', 'perezoso', 'rotación', 'simplificación', 'transpiración', 'allá', 'burro', 'celoso', 'dividendo', 'escuchar', 'papa', 'mi', 'perfecto', 'ruana', 'transportador', 'alma', 'buscar', 'célula', 'divisible', 'perforadora', 'sinagoga', 'trapecio', 'almacen', 'buseta', 'división', 'esfero', 'microfilamento', 'perfume', 'sinceridad', 'traslación', 'almeja', 'buzo', 'divisor', 'esófago', 'traslúcidos', 'almidón', 'espacios', 'miércoles', 'perímetro', 'sinónimos', 'trasnochar', 'almohada', 'doce', 'espagueti', 'migración', 'permiso', 'sintaxis', 'trasplante', 'almojábana', 'documento', 'espalda', 'mil', 'perro', 'síntesis', 'trauma', 'almuerzo', 'celular', 'dolor', 'español', 'mil', 'sinverguenza', 'trece', 'alojar', 'cenicero', 'dolorosos', 'especial', 'milagro', 'persona', 'siquiatra', 'trecientos', 'altar', 'centiarea', 'domésticos', 'especialista', 'miligramo', 'sistema', 'treinta', 'alterado', 'centígrados', 'domingo', 'especie', 'trepan', 'alternativa', 'centígramo', 'espejo', 'milla', 'tres', 'alto', 'centílitro', 'dónde', 'esperar', 'millon', 'perspectiva', 'aluminio', 'centímetro', 'espeso', 'millones', 'pertenecer', 'alumno', 'dones', 'espina', 'mimar', 'pertenencia', 'triangulo', 'Alvarado', 'centralismo', 'dormir', 'Espinal', 'Perú', 'alveólos', 'centro', 'dos', 'espinilla', 'ministerio', 'pesebre', 'alza', 'Centroamérica', 'espiración', 'pesimista', 'trimestral', 'amable', 'cepillo', 'espíritu', 'peso', 'sístole', 'trípode', 'Amalfí', 'pestaña', 'sobresabana', 'triptongo', 'amanecer', 'doscientos', 'esponja', 'pestañas', 'sobrino', 'trisílaba', 'amante', 'cerca', 'doxología', 'esposa', 'petroleo', 'social', 'triste', 'amargo', 'cerco', 'ductilidad', 'esposas', 'pez', 'sociales', 'trombosis', 'amarillo', 'cerdo', 'duele', 'esposo', 'PI', 'socio', 'amasar', 'cerebro', 'dulce', 'esposos', 'picar', 'sociolingüista', 'ambicioso', 'cero', 'duodeno', 'esta', 'pie', 'sofá', 'ambientador', 'Cerrito', 'durazno', 'estadística', 'Piedras', 'Sogamoso', 'troposfera', 'Ambón', 'cerveza', 'duro', 'estado', 'sol', 'tu', 'ameba', 'cesarea', 'estallar', 'pierna', 'Soledad', 'amenaza', 'Chachaguí', 'estamos', 'ministro', 'pies', 'solidificación', 'Tumaco', 'América', 'champiñones', 'estampado', 'minuendo', 'pijáo', 'solo', 'Tunja', 'amígdala', 'champú', 'estampilla', 'minuto', 'piloto', 'Túquerres', 'amigo', 'chapetón', 'estancar', 'mio', 'piña', 'soltero', 'Turbaco', 'amonestar', 'chaqueta', 'estática', 'miopía', 'piñata', 'solución', 'Turbaná', 'amor', 'Charalá', 'estatua', 'Miquéas', 'pincel', 'sombra', 'turnar', 'amorosa', 'estatuto', 'miriámetro', 'Pinchote', 'sombrero', 'turno', 'Amós', 'Charta', 'estéril', 'pingüino', 'soñar', 'tutor', 'amperímetro', 'Chef', 'esternocleidomastoideo', 'misericordia', 'pintar', 'Sonsón', 'tuyo', 'amplificación', 'Chima', 'Esther', 'Mistrato', 'sopa', 'twitter', 'ampollas', 'Chimichagua', 'estola', 'mitocondria', 'Soplaviento', 'amputar', 'Chinacota', 'estómago', 'mitosis', 'pintura', 'soplo', 'anafase', 'Chinchiná', 'estopa', 'moda', 'piojo', 'sordo', 'Anapoima', 'Chinú', 'estrategia', 'pirámide', 'sordociego', 'anaranjado', 'chispa', 'estreñimiento', 'modelaje', 'pirata', 'sorpresa', 'anatomía', 'chistoso', 'estuche', 'modelo', 'Pivijay', 'soy', 'ancho', 'chivo', 'estudiante', 'Mogotes', 'piyama', 'suave', 'anciano', 'Choachí', 'estudiar', 'Moisés', 'pizza', 'subconjunto', 'Androi', 'Choco', 'estudio', 'mojar', 'plancha', 'subir', 'andropausia', 'chocolate', 'molares', 'plano', 'anélidos', 'Chocontá', 'molécula', 'anestesiólogo', 'cianobacterias', 'estufa', 'molestar', 'anexar', 'ciclo', 'eterno', 'moluscos', 'sucio', 'anfíbio', 'ciego', 'ética', 'Mompós', 'sudadera', 'angiospermas', 'cien', 'etopeya', 'Mongoles', 'sudor', 'Angostura', 'Cienaga', 'eucaristía', 'mono', 'plaquetas', 'suegro', 'ángulo', 'científico', 'Eva', 'monomio', 'plasma', 'sueño', 'ciento', 'Evangelio', 'monosílaba', 'plata', 'sufijo', 'Cimitarra', 'evaporación', 'monoteismo', 'plátano', 'suicidio', 'cinco', 'evidente', 'mónstruo', 'suma', 'evitar', 'platón', 'sumados', 'exacta', 'Montenegro', 'playa', 'superficie', 'cincuenta', 'exagerar', 'mora', 'plomero', 'supermercado', 'cine', 'examen', 'moral', 'pluma', 'Supia', 'cinematógrafo', 'morder', 'pluricelular', 'suposición', 'cinética', 'excremento', 'moreno', 'pobre', 'suspender', 'excretor', 'morfema', 'poco', 'sustancia', 'Circasia', 'excretora', 'morfología', 'anidación', 'circuito', 'exhibicionista', 'morir', 'poder', 'sustantivo', 'animal', 'exhibir', 'morral', 'poeta', 'animales', 'Éxodo', 'mostrar', 'polea', 'ánimo', 'circulatorio', 'experto', 'motora', 'polígono', 'sustraendo', 'año', 'circunferencia', 'explicar', 'mover', 'polinomio', 'suyo', 'años', 'exportar', 'mucho', 'polisílaba', 'años', 'exposición', 'pollito', 'antena', 'cirugía', 'expresión', 'muerte', 'pollo', 'cirujano', 'Polonuevo', 'antes', 'Cisneros', 'expresivo', 'mujer', 'poltrona', 'expulsar', 'multiplicación', 'Ponedera', 'extensión', 'ponqué', 'antifaz', 'citoplasma', 'extrañar', 'Antióquia', 'civil', 'extranjerismo', 'antología', 'civismo', 'extremidades', 'antónimo', 'clan', 'antropólogo', 'claro', 'anual', 'clase', 'muñeco', 'anunciación', 'municipio', 'aparato', 'porción', 'portada', 'Apartadó', 'portatil', 'apartamento', 'porteria', 'apenas', 'postulado', 'clip', 'potenciación', 'Apocalipsis', 'clítoris', 'practicar', 'apoyar', 'clorofila', 'Prado', 'aprender', 'club', 'preguntame', 'apretado', 'coagulación', 'preguntar', 'aprovechado', 'cobija', 'música', 'premisa', 'aprovechar', 'cocina', 'mutaciones', 'premolares', 'Apulo', 'coco', 'preocupado', 'aquí', 'cocodrilo', 'presbicia', 'arácnidos', 'Cocorná', 'presentar', 'araña', 'código', 'presente', 'Aratoca', 'Coello', 'presidente', 'árbitro', 'coger', 'árbol', 'colaboración', 'prestar', 'arcilla', 'coleccionar', 'área', 'colectivo', 'colegio', 'primero', 'arepa', 'primo', 'argumentación', 'principio', 'Armenia', 'coloidal', 'ARN', 'Colombia', 'prisma', 'aroma', 'colon', 'probabilidad', 'aromática', 'colonia', 'arrastrar', 'colonizador', 'problema', 'arreglar', 'colorear', 'arrendar', 'colores', 'productor', 'arrepentimiento', 'colorete', 'profase', 'arriba', 'Colosenses', 'profesional', 'arriesgar', 'columna', 'profesor', 'arroba', 'profesores', 'arroz', 'coma', 'arruga', 'combinación', 'arrugada', 'comedia', 'prohibir', 'arrugado', 'comedor', 'prólogo', 'comensalismo', 'promesa', 'comenzar', 'comer', 'pronombre', 'artículo', 'comida', 'artrópodos', 'comisión', 'pronto', 'arveja', 'propiedad', 'arzobispo', 'cómo', 'asaltar', 'asamblea', 'proporciones', 'ascender', 'prosopografía', 'asexual', 'compañero', 'próspero', 'asfixia', 'protón', 'asignar', 'comparar', 'proximo', 'asistir', 'compás', 'prudente', 'asma', 'complemento', 'pueblo', 'asociación', 'completo', 'asombrar', 'comportamiento', 'aspiración', 'comprar', 'puede', 'aspiradora', 'comprensibilidad', 'asquelmintos', 'comprensión', 'astrólogo', 'compromiso', 'astronauta', 'compuesto', 'computador', 'asunto', 'computadores', 'pulga', 'asustado', 'comulgar', 'pulgada', 'asustarse', 'comunero', 'pulido', 'atención', 'comunicación', 'pulir', 'aterrar', 'pulmones', 'atmósfera', 'comunidad', 'pulpo', 'átomo', 'puma', 'atraccion', 'comunión', 'punto', 'atrapar', 'con', 'atrasado', 'concepción', 'atrevido', 'conceptual', 'audición', 'conciencia', 'auditiva', 'concilio', 'auditor', 'concordato', 'puntual', 'aula', 'concreto', 'pupila', 'aurora', 'concupiscencia', 'Purificación', 'automático', 'concurso', 'purificador', 'autónomo', 'condecorar', 'purísima', 'autopista', 'autor', 'conducta', 'autorizar', 'conejo', 'autoservicio', 'conferencia', 'auxiliar', 'confesión', 'avanzado', 'confianza', 'avanzar', 'confirmación', 'aventura', 'confirmar', 'conflicto', 'aves', 'confrontar', 'avión', 'confuso', 'avisar', 'congelar', 'aviso', 'axioma', 'conjunción', 'ayer', 'conjunto', 'ayuda', 'ayudar', 'azteca', 'azucar', 'azul', 'cono', 'conocer', 'consecutivo', 'conservación', 'consonante', 'Constantinopla', 'consuelo', 'consumidor', 'contado', 'contar', 'contemporáneo', 'contenido', 'contento', 'contexto', 'contiene', 'continuar', 'contralor', 'contrarreforma', 'Copacabana', 'Copón', 'coqueta', 'corazón', 'corazones', 'corbata', 'corchete', 'Córdoba', 'Corintios', 'Coromoro', 'correa', 'correcto', 'correr', 'correspondencia', 'corriente', 'corroer', 'corrupción', 'cosecante', 'cosecha', 'cosencante', 'coseno', 'costumbre', 'cotangente', 'crecer', 'crédito', 'credo', 'cremallera', 'Cristo', 'crítica', 'criticar', 'cromoplastos', 'cromosomas', 'crucifijo', 'cruz', 'cuaderno', 'cuadrícula', 'cuadro', 'cuadrupedos', 'cuajada', 'cuál', 'cualidad', 'cualquiera', 'cuándo', 'cuantificadores', 'cuánto', 'cuarenta', 'cuaresma', 'cuarta', 'cuatro', 'cuatrocientos', 'Cuba', 'Cubarral', 'cubrelecho', 'cucaracha', 'cuchilla', 'Cúcuta', 'cuello', 'cuero', 'cuerpo', 'cuidado', 'culebra', 'culpa', 'cultural', 'cuñado', 'curioso', 'curita', 'curso', 'curuba', 'curva', 'custodia', 'cutaneo']

def simplify_text_for_sign_language(frase):
    chat_completion = client.chat.completions.create(
            messages=[
                {
                    "role": "system",
                    "content": "Eres un bot que simplifica texto para poder ser traducido a lenguaje de señas. Por favor, simplifica el siguiente texto eliminando las palabras innecesarias para la compresion en lenguaje de señas como lo podrian ser algunos conectores. El texto devuelto no puede tener signos de puntuacion o numeros, pero si letras y tildes. Intenta acortar el texto lo maximo posible sin perder su significado.",
                },
                {
                    "role": "user",
                    "content": frase,
                }
            ],
            model="llama-3.3-70b-versatile",
        )

    frase = chat_completion.choices[0].message.content
    print(f"Texto simplificado: {frase}")
    return frase


def clear_folders():
    for folder in [imgLenguaje]:
        if os.path.exists(folder):
            # Eliminar archivos dentro de la carpeta
            for archivo in os.listdir(folder):
                archivo_path = os.path.join(folder, archivo)  # 🔹 Ruta correcta
                if os.path.isfile(archivo_path):
                    os.remove(archivo_path)  # Elimina archivos
                elif os.path.isdir(archivo_path):
                    shutil.rmtree(archivo_path)  # Elimina subcarpetas

def normalize_text(texto):
    texto = texto.lower()
    return ''.join(c for c in unicodedata.normalize('NFD', texto) if unicodedata.category(c) != 'Mn')

def filter_words(frase, lista_palabras):
    frase = normalize_text(frase)
    palabras = frase.split()
    resultado = [palabra if palabra in lista_palabras else list(palabra) for palabra in palabras]
    return [item for sublist in resultado for item in (sublist if isinstance(sublist, list) else [sublist])]

def download_images(lista_palabras):
    url_base = "https://hetah.net/_assets/modules/traductor/img/"
    imagenes_descargadas = []

    if not os.path.exists(imgLenguaje):
        os.makedirs(imgLenguaje)

    for palabra in lista_palabras:
        ruta_guardado = os.path.join(imgLenguaje, f"{palabra}.jpg")

        # Si la imagen ya existe, no se descarga nuevamente
        if os.path.exists(ruta_guardado):
            print(f"⏩ Imagen ya existente: {palabra}.jpg (omitida)")
            imagenes_descargadas.append(ruta_guardado)
            continue

        url_imagen = f"{url_base}alfabeto/{palabra}.jpg" if len(palabra) == 1 else f"{url_base}{palabra[0]}/{palabra}.jpg"

        try:
            respuesta = requests.get(url_imagen, timeout=5)
            respuesta.raise_for_status()

            with open(ruta_guardado, "wb") as file:
                file.write(respuesta.content)

            print(f"✅ Imagen descargada: {palabra}.jpg")
            imagenes_descargadas.append(ruta_guardado)
        except requests.RequestException:
            print(f"⚠️ No se pudo descargar: {url_imagen}")

    return imagenes_descargadas

def crop_images(imagenes_ordenadas):
    """Recorta las imágenes en fragmentos de 320x240 y las guarda ordenadas."""
    fragmentos = []
    
    for archivo in os.listdir(imgLenguaje):
        ruta_imagen = os.path.join(imgLenguaje, archivo)
        
        if archivo.endswith(".jpg"):
            img = Image.open(ruta_imagen)  # Abre la imagen
            ancho, alto = img.size

            # Divide en fragmentos de 240px de altura
            for i in range(0, alto, 240):
                fragmento = img.crop((0, i, 320, i + 240))
                fragmento_path = os.path.join(imgLenguaje, f"{archivo}_part_{i//240}.jpg")
                fragmento.save(fragmento_path)
                fragmentos.append(fragmento_path)
            
            img.close()  # Cierra la imagen después de usarla
    
    return fragmentos

def assemble_images_into_video(imagenes_ordenadas, output_path):
    """Genera un video con las imágenes en el orden correcto usando MoviePy."""
    fps = 18
    if not imagenes_ordenadas:
        print("⚠️ No hay imágenes para generar el video.")
        return

    # Crear el clip de video con las imágenes ordenadas
    clip = ImageSequenceClip(imagenes_ordenadas, fps=fps)
    
    # Guardar el video en el path de salida
    clip.write_videofile(output_path, codec="libx264", fps=fps)

def generate_video_signs(frase):
    # frase = simplify_text_for_sign_language(frase)
    resultado = filter_words(frase, list_words)

    # Descargar imágenes en orden
    imagenes_ordenadas = download_images(resultado)

    # Recortar imágenes y obtener fragmentos en orden
    fragmentos_ordenados = crop_images(imagenes_ordenadas)

    # Generar video con imágenes en el orden correcto
    assemble_images_into_video(fragmentos_ordenados, video_path)

    clear_folders()  # Asegurar que la carpeta de imágenes se limpia después
    print(f"🎥 Video de señas generado")